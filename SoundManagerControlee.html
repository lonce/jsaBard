<!-- /* ---------------------------------------------------------------------------------------
This jsaSound Code is distributed under LGPL 3
Copyright (C) 2012 National University of Singapore
Inquiries: director@anclab.org

This library is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.
This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNULesser General Public License for more details.
You should have received a copy of the GNU General Public License and GNU Lesser General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>
------------------------------------------------------------------------------------------*/ --><html>
<head>
<!--  Kumar Subramanian (http://nishabdam.com) is the Guru responsible for the party node.js architecture! 
// Modified, adapted, and further messed with by:
//	Lonce Wyse, July 2012
//------------------------------ -->
 <!-- ---------------------------------------------------------------------------
This code demonstrates 
	a) Using a dynamically created list selector to choose sound models,
	b) a dynamically created "Player" to display sliders for sound model parameters
	c) Using the phone to control sounds ...
------------------------------------------------------------------------------- -->   

	<!-- #include for node party connection with phone -->
	<script type="text/javascript">	
		var jsaHost="animatedsoundworks.com:8000";
	</script>
    <script src="http://animatedsoundworks.com:8000/socket.io/socket.io.js"> </script>		
	<script src="controlHandler.js"></script>
	<!-- --------------------------------------------- -->
		
	<!-- #include files for the sound models -->
	<script src="jsaComponents/jsaAudioComponents.js"></script>
	<script src="jsaUtils/utils.js"></script>
	<!-- ------------------------------------->
	
	<!--  list of sound models to incude -->
    <script src="jsaModels/OscTest9.js"></script>
	<script src="jsaModels/myFM1.js"></script>
	<script src="jsaModels/noisyFM.js"></script>
	<!--   <script src="jsaModels/MetaDrone1.js"></script>   -->
	<script src="jsaModels/filteredNoiseBand.js"></script>
	<script src="jsaModels/MetaDrone2.js"></script>
	<script src="jsaModels/Mp3.js"></script>
	<!--  ------------------------------ -->
	
	<!--  "Player" code -->
	<script src="jsaComponents/sliderBox.js"></script>
	
	<!--  Sound loading and management code --------------------------------------- -->
	<script type="text/javascript">	
		var currentSndModel;
		var m_handler;
		
		window.addEventListener("load", eventWindowLoaded, false);	
		
		function eventWindowLoaded () {		
			// create the sound selector box for the web page
			makeSoundListSelector();			
			// set up listening for network connections
			m_handler = controlHandler();
		}				
		
		// Names are arbitrary, makers must be defined in the "#include"ed sound model files above
		soundList = [{},
					 {name: "Square Wave", maker: oscFactory},
					 {name: "Classic FM", maker: jsaFMFactory},
					 {name: "Noisy FM", maker: jsaNoisyFMFactory},
					 //{name: "UglyMetadrone", maker: jsaMetaDrone1Factory},
					 {name: "Noise Band", maker: jsaFilteredNoiseBandFactory},
					 {name: "Metadrone2", maker: jsaMetaDrone2Factory},
					 {name: "mp3 Schumann", maker: mp3Factory}
					 ]
		
		// Create the html select box using the hard-coded soundList above		
		function makeSoundListSelector(){
			var select = document.getElementById("soundList");
			var foo;
			for (var i=0; i< soundList.length;i++){
				foo = soundList[i].name;
				if (soundList[i].name){
					select.options[select.options.length] = new Option(soundList[i].name);
				} else{
					select.options[select.options.length] = new Option();
				}					
			}	
		}
		
		// responde to sound selections be loading a sound as the current model
		function soundChoice() {
			var sb; // we'll send the message handler this object to control (its the slider box which has the same interface as a sound model)
			var mylist=document.getElementById("soundList");
			currentSndModel=soundList[mylist.selectedIndex].maker();  
			sb = makeSliderBox(currentSndModel);
			m_handler.setSM(sb);
		}
	</script>
</head>
<body>
<h1> Dynamically create model gui with sliders and text boxes for parameters </h1> 

<!-- Here we will dnamically create the sound list for selection  -->
Choose your sound model:
<select id="soundList" onchange="soundChoice()">
</select> 
<br>
<br>
<br>
<!-- ------------------------------------------------------------------- -->
<!--  and this is the phone party stuff   --------------------------------->
<hr />
	<div class="row">
		<h2 class="span8">You can also control these sounds from a chrome-enabled smart phone.</h2>
		Type this URL into your phone browser:  http://animatedsoundworks.com/ctlexp/control.html  (or use the QR code below) </br>
		<img border="0" src="./images/qrcode.6092328.controler.jpg" alt="Controller QRcode address" width="250" height="250" />
	</div>

	<div class="span2">
		<div class="span2 well" id="party_setup">
			 <div class="row">
				<div class="span2">
					Type the 9-letter code the phone receives, then press Join: </br>
					<input id="party_box" style="width:100px" type="text" autofocus placeholder="controller name"/>
					<button id="join_party" >Join</button>
				</div>
			</div>
		</div>
	 </div>

</body>
</html>